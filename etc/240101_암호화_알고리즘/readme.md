# μ•”νΈν™” μ•κ³ λ¦¬μ¦

## 1. μ •μ

μ•”νΈν™”λ” μ •λ³΄ λ³΄μ•μ μ¤‘μ”ν• κµ¬μ„± μ”μ†μ…λ‹λ‹¤.

- μ•”νΈν™”: **λ°μ΄ν„°λ¥Ό μ½μ„ μ μ—†λ” ν•νƒλ΅ λ³€ν™**ν•μ—¬ μ™Έλ¶€λ΅λ¶€ν„°μ λ¬΄λ‹¨ μ ‘κ·Όμ„ λ°©μ§€ν•λ” κΈ°μ .
- μ•”νΈν™” μ•κ³ λ¦¬μ¦: ν‰λ¬Έμ„ μ•”νΈλ¬ΈμΌλ΅ λ³€ν™ν•λ” λ° μ‚¬μ©λλ” μν•™μ  ν”„λ΅μ„Έμ¤.
- ν‰λ¬Έ(Plain Text): ν•΄λ… κ°€λ¥ν• ν•νƒ, μ¦‰ μ•”νΈν™” μ „μ λ©”μ‹μ§€
- μ•”νΈλ¬Έ(Cipher Text): ν•΄λ… λ¶κ°€λ¥ν• ν•νƒ, μ¦‰ μ•”νΈν™” ν›„μ λ©”μ‹μ§€
- μ•”νΈν™”(Encryption): ν‰λ¬Έμ„ μ•”νΈλ¬ΈμΌλ΅ λ³€ν™ν•λ” μ‘μ—…
- λ³µνΈν™”(Decryption): μ•”νΈλ¬Έμ„ ν‰λ¬ΈμΌλ΅ λ³€ν•ν•λ” μ‘μ—…

> μ•μ „ν• μ•”νΈμ—λ” **νΌλ(Confusion)**κ³Ό **ν™•μ‚°(Diffusion)**μ μ„±μ§μ΄ μμ–΄μ•Όν•λ‹¤ - ν΄λΌμ°λ“ μ„€λ„(Claude E. Shannon)

- νΌλ: μ•”νΈλ¬Έκ³Ό ν‰λ¬Έμ μƒκ΄€κ΄€κ³„λ¥Ό μ μ¶”ν•  μ μ—†κ² ν•λ” κ²ƒμ…λ‹λ‹¤. μλ¥Ό λ“¤μ–΄ abcdefλ¥Ό bcdefμ™€ κ°™μ΄ λ°”κΎΈλ©΄ μ μ¶”κ°€ κ°€λ¥ν•©λ‹λ‹¤. μΉν™(substitution)μΌλ΅ κµ¬ν„ κ°€λ¥. 
- ν™•μ‚°: ν‰λ¬Έμ ν†µκ³„μ  μ„±μ§μ„ μ•”νΈλ¬Έ μ „λ°μ— νΌνΈλ ¤ μ¨κΈ°λ” κ²ƒμ…λ‹λ‹¤. μλ¥Ό λ“¤μ–΄ ν‰λ¬Έμ΄ a a b aμΈλ° μ•”νΈλ¬Έμ—μ„ κ°™μ€ ν¨ν„΄μ΄ λ‚νƒ€λ‚λ” κ²ƒμ„ λ°©μ§€ν•΄μ•Ό ν•©λ‹λ‹¤. μ¬λ°°μ—΄(permutation)μΌλ΅ κµ¬ν„ κ°€λ¥ν•©λ‹λ‹¤.

## 2. μΆ…λ¥

### 2.1. λ‹¨λ°©ν–¥

- μ•”νΈν™”λ§ κ°€λ¥ν•κ³  λ³µνΈν™”λ” λ¶κ°€λ¥ν• μ•”νΈν™” μ•κ³ λ¦¬μ¦μ…λ‹λ‹¤.
- λ°μ΄ν„° λ¬΄κ²°μ„± κ²€μ¦, λ””μ§€ν„Έ μ„λ…, μ•”νΈν™” ν‚¤μ μƒμ„± λ“±μ— μ‚¬μ©λ©λ‹λ‹¤.
- λ‹¨λ°©ν–¥ μ•”νΈν™”μ λ€ν‘μ μΈ μλ΅λ” ν•΄μ‹ ν•¨μκ°€ μμµλ‹λ‹¤. ν•΄μ‹ ν•¨μλ” μ…λ ¥λ λ°μ΄ν„°λ¥Ό κ³ μ • κΈΈμ΄μ ν•΄μ‹κ°’μΌλ΅ λ³€ν™ν•©λ‹λ‹¤. ν•΄μ‹κ°’μ€ μ…λ ¥λ λ°μ΄ν„°μ™€ λ™μΌν•μ§€λ§, μ…λ ¥λ λ°μ΄ν„°λ¥Ό ν•΄μ‹κ°’μΌλ΅λ¶€ν„° λ³µμ›ν•  μλ” μ—†μµλ‹λ‹¤.

> π’΅ **ν•΄μ‹ ν•¨μ?**
> μ„μμ ν¬κΈ°μ λ°μ΄ν„°λ¥Ό κ³ μ •λ ν¬κΈ°μ κ³ μ ν• λ°μ΄ν„°λ΅ λ§¤ν•‘ν•λ” ν•¨μμ…λ‹λ‹¤. μλ¥Ό λ“¤μ–΄ μ–΄λ–¤ μ«μλ¥Ό 10μΌλ΅ λ‚λ λ‚λ¨Έμ§€λ¥Ό κµ¬ν•λ” ν•¨μλ„, ν•­μƒ 0~9λΌλ” λ™μΌν• ν¬κΈ°μ κ°’ μ¤‘ ν•λ‚κ°€ λ‚μ¤κΈ° λ•λ¬Έμ— ν•΄μ‹ ν•¨μμ…λ‹λ‹¤. μ„λ΅ λ‹¤λ¥Έ μ…λ ¥μ— λ€ν•΄ λ™μΌν• μ¶λ ¥μ΄ λ‚μ¤λ” κ²½μ°λ¥Ό ν•΄μ‹ μ¶©λμ΄λΌκ³  λ¶€λ¦…λ‹λ‹¤.

#### 2.1.1 SHA(Secure Hash Algorithm)

- SHA-2μ—λ” SHA-224, SHA-256, SHA-384, SHA-512κ°€ μλ”λ°, μΌλ°μ μΌλ΅ **SHA-256**μ„ μλ―Έν•©λ‹λ‹¤.
- SHAλ” μ™ μ•μ „ν•κ°€μ”?
  - ν•­μƒ **κ³ μ •λ ν¬κΈ°μ ν•΄μ‹ κ°’**μ„ μƒμ„±ν•©λ‹λ‹¤. μλ¥Ό λ“¤μ–΄ SHA-256μ€ 256 λΉ„νΈμ κ²°κ³Ό κ°’μ΄ λ§λ“¤μ–΄μ§‘λ‹λ‹¤. ν•­μƒ κ²°κ³Όκ°€ λ™μΌν•κΈ° λ•λ¬Έμ— μ›λ¬Έμ„ μ μ¶”ν•κΈ° μ–΄λ µμµλ‹λ‹¤.
  - λ‹¤λ¥Έ μ…λ ¥μ— λ€ν•΄ λ™μΌν• ν•΄μ‹ κ°’μ΄ μƒμ„±λ  ν™•λ¥ μ΄ λ§¤μ° λ‚®μµλ‹λ‹¤. μ¦‰ **λ‚®μ€ ν•΄μ‹ μ¶©λ λ°μƒ κ°€λ¥μ„±**μ„ κ°–κ³  μμµλ‹λ‹¤.
  - ν•΄μ‹ ν•¨μλ” μΌλ°©ν–¥ ν•¨μμ΄κΈ° λ•λ¬Έμ—, ν•΄μ‹ κ°’μ„ ν†µν•΄ μ›λ³Έ λ°μ΄ν„°λ¥Ό λ³µμ›ν•λ” κ²ƒμ€ λ§¤μ° μ–΄λ µμµλ‹λ‹¤. μ¦‰, ν•΄μ‹ κ°’μ„ μ•μ•„λ„ μ›λ³Έ λ°μ΄ν„°λ¥Ό μ°Ύλ” κ²ƒμ΄ μ–΄λ µλ‹¤λ” κ²ƒμ„ μλ―Έν•©λ‹λ‹¤.
- λ‹¨μ μ€ μ—†λ‚μ”?
  - λ™μΌν• μ…λ ¥μ΄ λ™μΌν• μ¶λ ¥μ„ κ°–κΈ° λ•λ¬Έμ— λ³€ν™ κ°€λ¥ν• λ¨λ“  ν•΄μ‹ κ°’μ„ λ―Έλ¦¬ κµ¬ν•΄λ‘ μ μμµλ‹λ‹¤. μ΄λ¬ν• ν‘λ¥Ό **λ μΈλ³΄μ° ν…μ΄λΈ”**μ΄λΌκ³  λ¶€λ¦…λ‹λ‹¤. ν•μ§€λ§ μ„μμ λ¬Έμμ—΄μΈ **salt**λ¥Ό μ¶”κ°€ν•μ—¬ λ μΈλ³΄μ° ν…μ΄λΈ”μ„ λ¬΄λ ¥ν™”ν•  μ μμµλ‹λ‹¤.

#### 2.1.2 MD5

- 128λΉ„νΈ κΈΈμ΄μ ν•΄μ‹ κ°’μ„ μƒμ„±ν•λ” λ‹¨λ°©ν–¥ μ•”νΈν™” ν•¨μμ…λ‹λ‹¤.
- ν„μ¬λ” **λ³΄μ• μ·¨μ•½μ **μΌλ΅ μΈν•΄ μ•μ „ν•μ§€ μ•λ‹¤κ³  μ—¬κ²¨μ§€λ©° μ£Όλ΅ κ°„λ‹¨ν• λ¬΄κ²°μ„± ν™•μΈ λ“±μ— μ‚¬μ©λ©λ‹λ‹¤.

### 2.2 μ–‘λ°©ν–¥

μ•”νΈν™”μ™€ λ³µνΈν™”κ°€ λ¨λ‘ κ°€λ¥ν• μ•”νΈν™” μ•κ³ λ¦¬μ¦μ…λ‹λ‹¤. μ–‘λ°©ν–¥ μ•”νΈν™”λ” ν¬κ² λ€μΉ­ ν‚¤ μ•”νΈν™”μ™€ λΉ„λ€μΉ­ ν‚¤ μ•”νΈν™”λ΅ λ‚λ μ μμµλ‹λ‹¤.

#### 2.2.1 λ€μΉ­ ν‚¤(λΉ„κ³µκ° ν‚¤)

λ™μΌν• ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ μ•”νΈν™” λ° λ³µνΈν™”λ¥Ό μν–‰ν•©λ‹λ‹¤. λ€μΉ­ ν‚¤ μ•”νΈν™”λ” λΉ„κµμ  λΉ λ¥΄κ³  ν¨μ¨μ μ΄μ§€λ§, ν‚¤λ¥Ό κ³µμ ν•΄μ•Ό ν•λ‹¤λ” λ‹¨μ μ΄ μμµλ‹λ‹¤.

#### 2.2.1.1 AES(Advanced Encryption Standard)

- λ€μΉ­ ν‚¤ μ•”νΈν™”μ λ€ν‘μ μΈ μ•κ³ λ¦¬μ¦μ…λ‹λ‹¤.
- **128 λΉ„νΈ ν¬κΈ°μ μ•”νΈν™” λΈ”λ΅**
- **128, 192, 256 λΉ„νΈ ν¬κΈ°μ ν‚¤**
- μ•μ „μ„±κ³Ό ν¨μ¨μ„±μΌλ΅ λ„λ¦¬ μ‚¬μ©λ©λ‹λ‹¤.
- λ―Έκµ­ μ •λ¶€ ν‘μ¤€ μ•”νΈν™” μ•κ³ λ¦¬μ¦μ΄λ©° κΈ°λ°€ λ¬Έμ„ μ•”νΈν™”μ— μ‚¬μ©λ©λ‹λ‹¤.
- AESλ” μ™ μ•μ „ν•κ°€μ”?
  - μ•”νΈλ¥Ό ν•΄λ…ν•λ” κ°€μ¥ ν¨κ³Όμ μΈ κ³µκ²© μ¤‘ ν•λ‚λ” λ¨λ“  κ²½μ°μ μλ¥Ό κ³„μ‚°ν•λ” λΈλ£¨νΈ ν¬μ¤μ…λ‹λ‹¤. 256 λΉ„νΈμ ν‚¤λ¥Ό μ‚¬μ©ν•  κ²½μ° 2^256μ κ²½μ°μ μμ— λ€ν•΄ κ³„μ‚°ν•΄μ•Ό ν•λ©°, ν„λ€ μ»΄ν“¨ν„°λ΅λ” λ§¤μ° κΈ΄ μ‹κ°„μ΄ κ±Έλ¦½λ‹λ‹¤.
  - κµ­μ  ν‘μ¤€μΌλ΅ μ±„νƒλμ–΄ λ„λ¦¬ μ‚¬μ©λκ³  μμΌλ©°, λ§μ€ μ „λ¬Έκ°€λ“¤κ³Ό μ•”νΈν•™ μ»¤λ®¤λ‹ν‹°μ—μ„ κ²€μ¦μ„ λ°›μ€ μ•κ³ λ¦¬μ¦μ…λ‹λ‹¤. κ²€μ¦λ μ•κ³ λ¦¬μ¦μ€ μƒλ΅μ΄ κ³µκ²©μ— λ€ν• μ €ν•­λ ¥μ΄ μλ”μ§€ ν™•μΈν•κΈ° μ„ν•΄ κ³„μ†ν•΄μ„ ν‰κ°€λκ³  κ°μ„ λ©λ‹λ‹¤.
- λ‹¨μ μ€ μ—†λ‚μ”?
  - λ€μΉ­ ν‚¤ λ°©μ‹μ΄κΈ° λ•λ¬Έμ— ν‚¤ λ…Έμ¶μ„ μ£Όμν•΄μ•Ό ν•©λ‹λ‹¤.

> π’΅ AESλ” λ―Έκµ­ ν‘μ¤€ κΈ°μ  μ—°κµ¬μ†μ ν‘μ¤€ μ•”νΈν™” μ•κ³ λ¦¬μ¦μ„ κ°€λ¦¬ν‚¤λ” λ…μΉ­μ΄λ©°, ν„μ¬μ AESλ” Rijndael(λ μΈλ‹¬) μ•κ³ λ¦¬μ¦μ„ κ°€λ¦¬ν‚µλ‹λ‹¤. μ—„λ°€ν•κ²λ” Rijndael μ•κ³ λ¦¬μ¦μ μ—¬λ¬ κ°€λ¥μ„± μ¤‘, μ•”νΈν™” λΈ”λ­μ ν¬κΈ°κ°€ 128 λΉ„νΈμ΄λ©° μ•”νΈν™” ν‚¤μ κΈΈμ΄κ°€ 128, 192, 256λΉ„νΈμΈ μ„Έ κ°€μ§€ μΆ…λ¥κ°€ AES ν‘μ¤€μΌλ΅ μ§€μ •λμ—μµλ‹λ‹¤.

#### 2.2.1.2 DES(Data Encryption Standard)

- AES μ΄μ „μ ν‘μ¤€μ…λ‹λ‹¤.
- 56 λΉ„νΈμ ν‚¤λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.
- 1990λ…„λ€ μ΄ν›„ κΈ°μ μ λ°μ „μΌλ΅ ν•λ£¨ μ •λ„μ μ‹κ°„μΌλ΅ ν•΄λ… κ°€λ¥ν•κ² λμ—μµλ‹λ‹¤.

#### 2.2.2 λΉ„λ€μΉ­ ν‚¤(κ³µκ° ν‚¤)

μ„λ΅ λ‹¤λ¥Έ ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ μ•”νΈν™” λ° λ³µνΈν™”λ¥Ό μν–‰ν•©λ‹λ‹¤. κ³µκ° ν‚¤λ” λ„κµ¬λ‚ μ‚¬μ©ν•  μ μλ” ν‚¤μ΄κ³ , κ°μΈ ν‚¤λ” μ†μ μλ§ μ‚¬μ©ν•  μ μλ” ν‚¤μ…λ‹λ‹¤. λΉ„λ€μΉ­ ν‚¤ μ•”νΈν™”λ” λ€μΉ­ ν‚¤ μ•”νΈν™”μ— λΉ„ν•΄ λλ¦¬μ§€λ§, ν‚¤ κ³µμ μ ν•„μ”μ„±μ΄ μ—†κΈ° λ•λ¬Έμ— λ³΄μ•μ„±μ΄ λ” λ†’μµλ‹λ‹¤.

- ν‚¤ μ „λ‹¬ κ³Όμ •μ—μ„ μ•”νΈν™” ν‚¤(κ³µκ°ν‚¤)κ°€ λ…Έμ¶λμ–΄λ„, λ³µνΈν™” ν‚¤(κ°μΈν‚¤)κ°€ μ—†μΌλ©΄ ν•΄λ…μ΄ λ¶κ°€ν•©λ‹λ‹¤.
- μ—­μΌλ΅ κ°μΈν‚¤λ΅ μ•”νΈν™”, κ³µκ°ν‚¤λ΅ λ³µνΈν™”ν•λ” λ°©μ‹μΌλ΅ μ„λ…μ— μ‚¬μ©ν•  μ μμµλ‹λ‹¤.

#### 2.2.2.1 RSA(Rivestβ€“Shamirβ€“Adleman)

- κ³µκ° ν‚¤ μ•”νΈν™”μ λ€ν‘μ μΈ μ•κ³ λ¦¬μ¦μ…λ‹λ‹¤.
- κ³µκ° ν‚¤μ™€ κ°μΈ ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ λ°μ΄ν„°λ¥Ό μ•”νΈν™” λ° λ³µνΈν™”ν•©λ‹λ‹¤.
- μ†μΈμ λ¶„ν•΄μ μ–΄λ ¤μ›€μ— κΈ°λ°ν•μ—¬ μ•μ „μ„±μ„ μ κ³µν•©λ‹λ‹¤.
- ν‚¤ μƒμ„± λ°©λ²•
  - λ‘ μ†μ pμ™€ qλ¥Ό μ¤€λΉ„ν•©λ‹λ‹¤.
  - N=pqλ¥Ό κµ¬ν•©λ‹λ‹¤. Nμ€ κ³µκ°ν‚¤μ μΌλ¶€κ°€ λ©λ‹λ‹¤.
  - C=(p-1)(q-1)μ„ κµ¬ν•©λ‹λ‹¤. Nλ³΄λ‹¤ μ‘μ€ μ •μ μ¤‘ Nκ³Ό μ„λ΅μ†μΈ κ°’λ“¤μ μμ…λ‹λ‹¤(μ¤μΌλ¬ νμ΄ ν•¨μ).
  - 1 < e < Cμ΄λ©°, Nκ³Ό Cμ™€ μ„λ΅μ†μΈ eλ¥Ό κµ¬ν•©λ‹λ‹¤.
  -  d * e % C = 1μΈ dλ¥Ό κµ¬ν•©λ‹λ‹¤.
  - Nκ³Ό eκ°€ κ³µκ°ν‚¤μ΄λ©°, ν‰μ„λ¬Έμ„ μ•”νΈλ¬ΈμΌλ΅ λ°”κΏ€ λ• μ”λ‹λ‹¤.
  - dκ°€ κ°μΈν‚¤μ΄λ©°, κ³µκ°ν‚¤λ΅ λ§λ“¤μ–΄μ§„ μ•”νΈλ¬Έμ„ ν•΄λ…ν•  λ• μ”λ‹λ‹¤.
- μ•”νΈν™” λ°©λ²•
  - A^e % N = B
  - B^d % N = A

- μμ‹
  - μ†μ κµ¬ν•κΈ°: p = 2, q = 7
  - N κµ¬ν•κΈ°: 2 * 7 = 14
  - C κµ¬ν•κΈ°: (2-1) * (7-1) = 6
  - e κµ¬ν•κΈ°: 1 < e < 6μ΄λ©°, 14, 6κ³Ό μ„λ΅μ† = 5
  - d κµ¬ν•κΈ°: d * 5 % 6 = 1 -> d = 11
  - κ³µκ° ν‚¤: (e, N) = (5, 14)
  - κ°μΈ ν‚¤: d = 11
  - ν‰λ¬Έ = 2
  - μ•”νΈν™”: 2^5 % 14 = 4
  - λ³µνΈν™”: 4^11 % 14 = 4194304 % 14 = 2 


> π’΅ **μ„λ΅μ†?**
> μµλ€κ³µμ•½μκ°€ 1μΈ μ

## 3. AES μ•κ³ λ¦¬μ¦

### 3.1 ν”„λ΅μ„Έμ¤

![image13](./image0.png)

- **Key Expansion**: μ£Ό μ•”νΈν™” ν‚¤(128,192,256)μ„ λ°›μ•„μ„ κ° λΌμ΄λ“μ—μ„ μ‚¬μ©ν•  10, 12, 14κ°μ 128 λΉ„νΈ **λΌμ΄λ“ ν‚¤λ¥Ό μƒμ„±**ν•©λ‹λ‹¤. Key Scheduleμ΄λΌκ³ λ„ λ¶€λ¦…λ‹λ‹¤.
- **μ΄λ‹μ…(0) λΌμ΄λ“:** ν‚¤ μµμ¤ν¬μ…μ—μ„ μ‚¬μ©ν• λΌμ΄λ“ ν‚¤ μ¤‘ μ²«λ²μ§Έ ν‚¤λ¥Ό μ‚¬μ©. **AddRoundKey**λ¥Ό ν• λ² μ‹¤ν–‰.
- **1 ~ N-1 λΌμ΄λ“**: **SubBytes**, **ShiftRows**, **MixColumns**, **AddRoundKey**λ¥Ό μμ„λ€λ΅ μ‹¤ν–‰. ν‚¤μ ν¬κΈ°μ— λ”°λΌ κ°κ° 9λ², 11λ², 13λ² μ‹¤ν–‰.
- **νμ΄λ„(10,12,14) λΌμ΄λ“**: **SubBytes**, **ShiftRows**, **AddRoundKey**λ¥Ό μμ„λ€λ΅ μ‹¤ν–‰

> π’΅ **μ΄λ―Έμ§€ μ¶μ² κ²Έ ν”„λ΅μ„Έμ¤ ν΄λ¦½ μμƒ**
> https://youtube.com/clip/UgkxTcXqYsnFtvFveihfmIfdiAI0IDWKc_TN?si=Sx3bqO2-fc60dhci

### 3.2 μμ‹

![image1](./image1.png)

- State Matrixλ” ν‰λ¬Έμ„ 128λΉ„νΈ(16λ°”μ΄νΈ) λ‹¨μ„λ΅ λ‚λ λΈ”λ΅μ…λ‹λ‹¤.
- μ•”νΈν™” ν‚¤ λν• 128λΉ„νΈμ…λ‹λ‹¤.

#### 3.2.1 Key Expansion(Key Schedule)

**λ©”μΈ μ•”νΈν™” ν‚¤λ΅λ¶€ν„° μ—¬λ¬ κ°μ λΌμ΄λ“ ν‚¤λ¥Ό λ§λ“¤μ–΄λ‚΄λ” μ‘μ—…**μ…λ‹λ‹¤. ν‚¤μ κΈΈμ΄(128, 192, 256)μ— λ”°λΌ μ΄ λΌμ΄λ“ μκ°€ λ‹¬λΌμ§€λ―€λ΅ λΌμ΄λ“ ν‚¤μ κ°μλ„ λ‹¬λΌμ Έμ•Ό ν•©λ‹λ‹¤. κ°κ° 10, 12, 14κ°μ λΌμ΄λ“ ν‚¤λ¥Ό λ§λ“­λ‹λ‹¤.

#### 3.2.1.1 μ•”νΈν™” ν‚¤μ 4μ—΄μ— λ€ν•΄ RotWord μν–‰

![image2](./image2.png)

> π’΅ **RotWord**
> 4λ°”μ΄νΈ μ›λ“λ¥Ό λ°”μ΄νΈ λ‹¨μ„λ΅ ν• μΉΈ Shift/Rotateν•λ” μ‘μ—…μ…λ‹λ‹¤. μ„ μμ‹μ—μ„ RotWord([09 cf 4f 3c]) = [cf 4f 3c 09]μ…λ‹λ‹¤. 

#### 3.2.1.2 RotWordλ 4μ—΄μ— λ€ν•΄ SubBytes μν–‰

![image3](./image3.png)

![image4](./image4.png)

![image5](./image5.png)

μ•”νΈν™” ν‚¤ ν–‰λ ¬μ κ° μ›μ† λ°”μ΄νΈλ¥Ό 4λΉ„νΈμ”© λ‚λ•λ‹λ‹¤. 4λΉ„νΈλ” 16μ§„μλ¥Ό λ‚νƒ€λƒ…λ‹λ‹¤. λ―Έλ¦¬ μ£Όμ–΄μ§„ S-Boxλ¥Ό κΈ°λ°μΌλ΅ κ° λ°”μ΄νΈλ¥Ό μΉν™ν•©λ‹λ‹¤. μ΄λ¥Ό SubBytesλΌκ³  λ¶€λ¦…λ‹λ‹¤. SubBytesμ™€ S-Boxλ” 3.2.2μ¥μ„ μ°Έκ³ ν•΄μ£Όμ„Έμ”.

#### 3.2.1.3 μ•”νΈν™” ν‚¤ 1μ—΄ xor RotWord, SubBytesλ 4μ—΄ xor Rcon 1μ—΄ = 1λΌμ΄λ“ ν‚¤ 1μ—΄

![image6](./image6.png)

![image7](./image7.png)

μ•”νΈν™” ν‚¤μ 4μ—΄μ— λ€ν•΄ RotWord λ° SubBytes μ‘μ—…μ΄ μ™„λ£λμ—μΌλ©΄, μ•”νΈν™” ν‚¤μ 1μ—΄, κ·Έλ¦¬κ³  Rconμ 1μ—΄κ³Ό XOR μ—°μ‚°μ„ μν–‰ν•©λ‹λ‹¤. μ—°μ‚° κ²°κ³Όκ°€ 1 λΌμ΄λ“ ν‚¤μ 1μ—΄μ΄ λ©λ‹λ‹¤.

Rconμ€ Round Constantsμ μ¤„μ„λ§λ΅, λ―Έλ¦¬ μ •μλ ν–‰λ ¬μ…λ‹λ‹¤. AES128μΈ κ²½μ° μ΄ 10κ°μ λΌμ΄λ“λ¥Ό μν–‰ν•λ―€λ΅ 4ν–‰ 10μ—΄μΈ Rconμ„ μ‚¬μ©ν•κ² λ©λ‹λ‹¤. Rconμ„ κµ¬ν•λ” μ ν™”μ‹μ΄ μλ”λ°, μ •ν™•ν μ–΄λ–¤ μλ―Έλ¥Ό κ°€μ§€λ”μ§€λ” μΆ€ λ” μ•μ•„λ΄μ•Όκ² μµλ‹λ‹¤.

![rcon](/Users/infomuscle/Desktop/bokeun/blog/temp/α„‹α…΅α†·α„’α…©α„’α…_α„‹α…΅α†―α„€α…©α„…α…µα„α…³α†·/rcon.png)

> π–‡ https://en.wikipedia.org/wiki/AES_key_schedule

#### 3.2.1.4 μ•”νΈν™” ν‚¤ nμ—΄ xor 1 λΌμ΄λ“ ν‚¤ n-1μ—΄ = 1 λΌμ΄λ“ ν‚¤ nμ—΄ (2<=n<=4)

![image8](./image8.png)

![image9](./image9.png)

![image10](./image10.png)

3.2.1.3μ—μ„ λ§λ“  1 λΌμ΄λ“ ν‚¤μ 1μ—΄κ³Ό μ•”νΈν™” ν‚¤μ 2μ—΄μ„ XOR μ—°μ‚°ν•©λ‹λ‹¤. κ·Έ κ²°κ³Όκ°€ 1 λΌμ΄λ“ ν‚¤μ 2μ—΄μ…λ‹λ‹¤. κ°™μ€ μ‘μ—…μ„ λ°λ³µν•μ—¬ 1 λΌμ΄λ“ ν‚¤μ 4μ—΄κΉμ§€ λ§λ“­λ‹λ‹¤.

#### 3.2.1.5 κ°™μ€ μ‘μ—… λ°λ³µν•μ—¬ 10, 12, 14 λΌμ΄λ“ ν‚¤κΉμ§€ μƒμ„±

![image11](./image11.png)

![image12](./image12.png)

1 λΌμ΄λ“ ν‚¤λ¥Ό λ§λ“¤μ—μΌλ©΄, 2 λΌμ΄λ“ ν‚¤λ¥Ό λ§λ“¤ μ°¨λ΅€μ…λ‹λ‹¤. 1 λΌμ΄λ“ ν‚¤λ¥Ό μ•”νΈν™” ν‚¤λ΅ ν•μ—¬, 3.2.1.1 ~ 3.2.1.4λ¥Ό λ°λ³µν•μ—¬ 2 λΌμ΄λ“ ν‚¤λ¥Ό λ§λ“­λ‹λ‹¤. κ°™μ€ λ°©μ‹μΌλ΅ 10 λΌμ΄λ“ ν‚¤κΉμ§€ λ§λ“­λ‹λ‹¤. μ•”νΈν™” ν‚¤ ν¬κΈ°μ— λ”°λΌ 12, 14 λΌμ΄λ“ ν‚¤κΉμ§€ λ§λ“¤ μ μμµλ‹λ‹¤.

#### 3.2.2 SubBytes

#### 3.2.2.1 S-Boxλ¥Ό κΈ°λ°μΌλ΅ State Matrixμ κ° μ›μ† λ°”μ΄νΈ μΉν™

![image13](./image13.png)

![image14](./image14.png)

![image15](./image15.png)

![image16](./image16.png)

SubBytesλ” μ•”νΈμ νΉμ„± μ¤‘ νΌλμ„ λ¶€μ—¬ν•κΈ° μ„ν•΄ κ°’μ„ μΉν™ν•λ” μ‘μ—…μ…λ‹λ‹¤. μ΄ λ• S-BoxλΌλ” λ―Έλ¦¬ μ£Όμ–΄μ§„ ν‘λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤. μƒνƒ ν–‰λ ¬μ€ μ΄ 128λΉ„νΈ, μ¦‰ 1λ°”μ΄νΈ * 16μ ν¬κΈ°λ¥Ό κ°€μ§„ 4x4 ν–‰λ ¬μ…λ‹λ‹¤. 16κ°μ λ°”μ΄νΈμ— λ€ν•΄ κ°κ° μΉν™ μ‘μ—…μ„ ν•©λ‹λ‹¤.

μΉν™ μ‘μ—…μ€ λ°”μ΄νΈλ¥Ό 4λΉ„νΈ μ”© λ‚λ„λ” κ²ƒμ—μ„λ¶€ν„° μ‹μ‘ν•©λ‹λ‹¤. 4λΉ„νΈλ” 16μ§„μλ΅ ν‘ν„ν•  μ μμµλ‹λ‹¤. 16x16μ ν‘μΈ S-Boxμ—μ„ μ• 4λΉ„νΈμ™€ λ’¤ 4λΉ„νΈκ°€ λ§λ‚λ” μ…€μ κ°’μ„ μ°Ύμ•„ μΉν™ν•©λ‹λ‹¤. μλ¥Ό λ“¤μ–΄ μ›λ λ°”μ΄νΈμ κ°’μ΄ 19μ€λ‹¤λ©΄, 10κ³Ό 09κ°€ λ§λ‚λ” D4μ κ°’μΌλ΅ λ°”κΏ‰λ‹λ‹¤.

#### 3.2.2.2 S-Box

![sbox](./sbox.png)

S-Boxλ” Substitution BoxλΌλ” λ»μ…λ‹λ‹¤. μ°Έκ³ λ΅ λ³µνΈν™” ν•  λ•λ” Inv S-Boxλ¥Ό μ”λ‹λ‹¤.

μ—¬κΈ°μ„λ¶€ν„΄ μ‚¬κ²¬μΈλ°, μ—­μ‹ λ―Έλ¦¬ μ •ν•΄μ§„ κ°’μ„ μ‚¬μ©ν•λ” μ •ν™•ν• μ΄μ λ” λ” μ•μ•„λ΄μ•Όκ² μµλ‹λ‹¤. AESμ λ©μ μ΄ ν‘μ¤€μ„ μ •μν•λ” κ²ƒμ΄κΈ° λ•λ¬ΈμΌ κ²ƒ κ°™λ‹¨ μ¶”μΈ΅μ΄ λ“¤κΈ΄ ν•λ„¤μ”. S-Boxλ¥Ό μ•μ•„λ„ μ•”νΈν™” ν‚¤λ¥Ό λΈλ£¨νΈ ν¬μ¤λ΅ μ•μ•„λ‚Ό μ μ—†μΌλ‹ μ•μ „μ„±λ„ μ¶©λ¶„ν•  κ²ƒμ΄κ³ μ”. λ§μ•½ λ” μ–΄λ µκ² ν•λ‹¤λ©΄ μ΄ S-Boxλ¥Ό λ”°λ΅ μ •μν•λ©΄ λ  κ²ƒλ„ κ°™κ³ μ”.

#### 3.2.3 ShiftRows

![image17](./image17.png)

![image18](./image18.png)

![image19](./image19.png)

![image20](./image20.png)

ShiftRowsλ” μ•”νΈμ νΉμ„± μ¤‘ ν™•μ‚°μ„ μ„ν•΄ μ¬λ°°μ—΄ ν•λ” μ‘μ—…μ…λ‹λ‹¤. ν–‰λ ¬μ nν–‰μ— λ€ν•΄ λ°”μ΄νΈ λ‹¨μ„λ΅ n-1λ§νΌ Shiftλ¥Ό μν–‰ν•©λ‹λ‹¤. 2ν–‰μ€ 1λ°”μ΄νΈλ§νΌ Shift ν•©λ‹λ‹¤. ShiftRows([27 bf b4 41]) = [bf b4 41 27]μ…λ‹λ‹¤. 3ν–‰μ€ 2λ°”μ΄νΈλ§νΌ Shift ν•©λ‹λ‹¤. ShiftRows([]) = [5d 52 11 98]μ…λ‹λ‹¤. 4ν–‰μ€ 3λ°”μ΄νΈλ§νΌ Shift ν•©λ‹λ‹¤. ShiftRows([ae f1 e5 30]) = [30 ae f1 e5]μ…λ‹λ‹¤.

#### 3.2.4 MixColumns

![image21](./image21.png)

![image22](./image22.png)

![image23](./image23.png)

![image24](./image24.png)

ShiftRowsκ°€ ν–‰ λ‹¨μ„λ΅ μ¬λ°°μ—΄ ν•λ” μ‘μ—…μ΄μ—λ‹¤λ©΄, MixColumnsλ” μ—΄ λ‹¨μ„λ΅ μ¬λ°°μ—΄ ν•λ” μ‘μ—…μ…λ‹λ‹¤. μ΄ λ•λ„ λ―Έλ¦¬ μ •μλ ν–‰λ ¬μ„ μ‚¬μ©ν•©λ‹λ‹¤. λ³µνΈν™” ν•  λ•λ” InvMixColumnsλΌκ³  ν•λ©°, λ§μ°¬κ°€μ§€λ΅ λ³„λ„λ΅ μ •μλ ν–‰λ ¬μ„ μ‚¬μ©ν•©λ‹λ‹¤.

#### 3.2.5 AddRoundKey

![image25](./image25.png)

![image26](./image26.png)

![image27](./image27.png)

![image28](./image28.png)

Key Expansionμ—μ„ λ§λ“  λΌμ΄λ“ ν‚¤μ κ° nμ—΄κ³Ό μƒνƒ ν–‰λ ¬μ κ° nμ—΄μ„ XOR μ—°μ‚°ν•λ” μ‘μ—…μ…λ‹λ‹¤. μ—¬κΈ°κΉμ§€ μν–‰ν•λ©΄ λΌμ΄λ“κ°€ μΆ…λ£λ©λ‹λ‹¤. λ‹¤λ¥Έ μ‘μ—…μ€ λΌμ΄λ“μ— λ”°λΌ κ°€κ°μ΄ λλ‚, AddRoundKeyλ” μ΄λ‹μ…λ¶€ν„° νμ΄λ„κΉμ§€ λ¨λ“  λΌμ΄λ“μ—μ„ μν–‰λ©λ‹λ‹¤.
